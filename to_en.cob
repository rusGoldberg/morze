IDENTIFICATION DIVISION.
PROGRAM-ID. TextToMorse.

ENVIRONMENT DIVISION.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-TEXT PIC X(100).
01 WS-MORSE PIC X(500) VALUE SPACES.
01 WS-CHAR PIC X.
01 WS-CODE PIC X(5).
01 WS-INDEX PIC 9(3) VALUE 1.
01 WS-LENGTH PIC 9(3).

01 MORSE-TABLE.
   05 FILLER PIC X(2) VALUE "A ".
   05 FILLER PIC X(5) VALUE ".-   ".
   05 FILLER PIC X(2) VALUE "B ".
   05 FILLER PIC X(5) VALUE "-... ".
   05 FILLER PIC X(2) VALUE "C ".
   05 FILLER PIC X(5) VALUE "-.-. ".
   05 FILLER PIC X(2) VALUE "D ".
   05 FILLER PIC X(5) VALUE "-..  ".
   05 FILLER PIC X(2) VALUE "E ".
   05 FILLER PIC X(5) VALUE ".    ".
   05 FILLER PIC X(2) VALUE "F ".
   05 FILLER PIC X(5) VALUE "..-. ".
   05 FILLER PIC X(2) VALUE "G ".
   05 FILLER PIC X(5) VALUE "--.  ".
   05 FILLER PIC X(2) VALUE "H ".
   05 FILLER PIC X(5) VALUE ".... ".
   05 FILLER PIC X(2) VALUE "I ".
   05 FILLER PIC X(5) VALUE "..   ".
   05 FILLER PIC X(2) VALUE "J ".
   05 FILLER PIC X(5) VALUE ".--- ".
   05 FILLER PIC X(2) VALUE "K ".
   05 FILLER PIC X(5) VALUE "-.-  ".
   05 FILLER PIC X(2) VALUE "L ".
   05 FILLER PIC X(5) VALUE ".-.. ".
   05 FILLER PIC X(2) VALUE "M ".
   05 FILLER PIC X(5) VALUE "--   ".
   05 FILLER PIC X(2) VALUE "N ".
   05 FILLER PIC X(5) VALUE "-.   ".
   05 FILLER PIC X(2) VALUE "O ".
   05 FILLER PIC X(5) VALUE "---  ".
   05 FILLER PIC X(2) VALUE "P ".
   05 FILLER PIC X(5) VALUE ".--. ".
   05 FILLER PIC X(2) VALUE "Q ".
   05 FILLER PIC X(5) VALUE "--.- ".
   05 FILLER PIC X(2) VALUE "R ".
   05 FILLER PIC X(5) VALUE ".-.  ".
   05 FILLER PIC X(2) VALUE "S ".
   05 FILLER PIC X(5) VALUE "...  ".
   05 FILLER PIC X(2) VALUE "T ".
   05 FILLER PIC X(5) VALUE "-    ".
   05 FILLER PIC X(2) VALUE "U ".
   05 FILLER PIC X(5) VALUE "..-  ".
   05 FILLER PIC X(2) VALUE "V ".
   05 FILLER PIC X(5) VALUE "...- ".
   05 FILLER PIC X(2) VALUE "W ".
   05 FILLER PIC X(5) VALUE ".--  ".
   05 FILLER PIC X(2) VALUE "X ".
   05 FILLER PIC X(5) VALUE "-..- ".
   05 FILLER PIC X(2) VALUE "Y ".
   05 FILLER PIC X(5) VALUE "-.-- ".
   05 FILLER PIC X(2) VALUE "Z ".
   05 FILLER PIC X(5) VALUE "--.. ".
   05 FILLER PIC X(2) VALUE "1 ".
   05 FILLER PIC X(5) VALUE ".---- ".
   05 FILLER PIC X(2) VALUE "2 ".
   05 FILLER PIC X(5) VALUE "..--- ".
   05 FILLER PIC X(2) VALUE "3 ".
   05 FILLER PIC X(5) VALUE "...-- ".
   05 FILLER PIC X(2) VALUE "4 ".
   05 FILLER PIC X(5) VALUE "....- ".
   05 FILLER PIC X(2) VALUE "5 ".
   05 FILLER PIC X(5) VALUE "..... ".
   05 FILLER PIC X(2) VALUE "6 ".
   05 FILLER PIC X(5) VALUE "-.... ".
   05 FILLER PIC X(2) VALUE "7 ".
   05 FILLER PIC X(5) VALUE "--... ".
   05 FILLER PIC X(2) VALUE "8 ".
   05 FILLER PIC X(5) VALUE "---.. ".
   05 FILLER PIC X(2) VALUE "9 ".
   05 FILLER PIC X(5) VALUE "----. ".
   05 FILLER PIC X(2) VALUE "0 ".
   05 FILLER PIC X(5) VALUE "----- ".
   05 FILLER PIC X(2) VALUE " ".
   05 FILLER PIC X(5) VALUE "| ".
   05 FILLER PIC X(2) VALUE ".".
   05 FILLER PIC X(5) VALUE ".-.-.- ".
   05 FILLER PIC X(2) VALUE ",".
   05 FILLER PIC X(5) VALUE "--..-- ".
   05 FILLER PIC X(2) VALUE "?".
   05 FILLER PIC X(5) VALUE "..--.. ".
   05 FILLER PIC X(2) VALUE "'".
   05 FILLER PIC X(5) VALUE ".----. ".
   05 FILLER PIC X(2) VALUE "!".
   05 FILLER PIC X(5) VALUE "-.-.-- ".
   05 FILLER PIC X(2) VALUE "/".
   05 FILLER PIC X(5) VALUE "-..-.".
   05 FILLER PIC X(2) VALUE "(".
   05 FILLER PIC X(5) VALUE "-.--.".
   05 FILLER PIC X(2) VALUE ")".
   05 FILLER PIC X(5) VALUE "-.--.-".
   05 FILLER PIC X(2) VALUE "&".
   05 FILLER PIC X(5) VALUE ".-...".
   05 FILLER PIC X(2) VALUE ":".
   05 FILLER PIC X(5) VALUE "---...".
   05 FILLER PIC X(2) VALUE ";".
   05 FILLER PIC X(5) VALUE "-.-.-.".
   05 FILLER PIC X(2) VALUE "=".
   05 FILLER PIC X(5) VALUE "-...-".
PROCEDURE DIVISION.
   DISPLAY "Enter text: " WITH NO ADVANCING.
   ACCEPT WS-TEXT.
   MOVE FUNCTION LENGTH(WS-TEXT) TO WS-LENGTH.

   PERFORM VARYING WS-INDEX FROM 1 BY 1 UNTIL WS-INDEX > WS-LENGTH
       MOVE FUNCTION UPPER-CASE(WS-TEXT(WS-INDEX:1)) TO WS-CHAR
       PERFORM FIND-MORSE
       MOVE WS-CODE TO WS-MORSE(WS-INDEX:)
   END-PERFORM.
   DISPLAY "Morse Code: " WS-MORSE.
   STOP RUN.
FIND-MORSE.
   EVALUATE WS-CHAR
       WHEN "A" MOVE ".-   " TO WS-CODE
       WHEN "B" MOVE "-... " TO WS-CODE
       WHEN "C" MOVE "-.-. " TO WS-CODE
       WHEN "D" MOVE "-..  " TO WS-CODE
       WHEN "E" MOVE ".    " TO WS-CODE
       WHEN "F" MOVE "..-. " TO WS-CODE
       WHEN "G" MOVE "--.  " TO WS-CODE
       WHEN "H" MOVE ".... " TO WS-CODE
       WHEN "I" MOVE "..   " TO WS-CODE
       WHEN "J" MOVE ".--- " TO WS-CODE
       WHEN "K" MOVE "-.-  " TO WS-CODE
       WHEN "L" MOVE ".-.. " TO WS-CODE
       WHEN "M" MOVE "--   " TO WS-CODE
       WHEN "N" MOVE "-.   " TO WS-CODE
       WHEN "O" MOVE "---  " TO WS-CODE
       WHEN "P" MOVE ".--. " TO WS-CODE
       WHEN "Q" MOVE "--.- " TO WS-CODE
       WHEN "R" MOVE ".-.  " TO WS-CODE
       WHEN "S" MOVE "...  " TO WS-CODE
       WHEN "T" MOVE "-    " TO WS-CODE
       WHEN "U" MOVE "..-  " TO WS-CODE
       WHEN "V" MOVE "...- " TO WS-CODE
       WHEN "W" MOVE ".--  " TO WS-CODE
       WHEN "X" MOVE "-..- " TO WS-CODE
       WHEN "Y" MOVE "-.-- " TO WS-CODE
       WHEN "Z" MOVE "--.. " TO WS-CODE
       WHEN "1" MOVE ".---- " TO WS-CODE
       WHEN "2" MOVE "..--- " TO WS-CODE
       WHEN "3" MOVE "...-- " TO WS-CODE
       WHEN "4" MOVE "....- " TO WS-CODE
       WHEN "5" MOVE "..... " TO WS-CODE
       WHEN "6" MOVE "-.... " TO WS-CODE
       WHEN "7" MOVE "--... " TO WS-CODE
       WHEN "8" MOVE "---.. " TO WS-CODE
       WHEN "9" MOVE "----. " TO WS-CODE
       WHEN "0" MOVE "----- " TO WS-CODE
       WHEN " " MOVE "| " TO WS-CODE
       WHEN "." MOVE ".-.-.- " TO WS-CODE
       WHEN "," MOVE "--..-- " TO WS-CODE
       WHEN "?" MOVE "..--.. " TO WS-CODE
       WHEN "'" MOVE ".----. " TO WS-CODE
       WHEN "!" MOVE "-.-.-- " TO WS-CODE
       WHEN "/" MOVE "-..-." TO WS-CODE
       WHEN "(" MOVE "-.--." TO WS-CODE
       WHEN ")" MOVE "-.--.-" TO WS-CODE
       WHEN "&" MOVE ".-..." TO WS-CODE
       WHEN ":" MOVE "---..." TO WS-CODE
       WHEN ";" MOVE "-.-.-." TO WS-CODE
       WHEN "=" MOVE "-...-" TO WS-CODE
       WHEN OTHER MOVE "     " TO WS-CODE
   END-EVALUATE.

   EXIT.
